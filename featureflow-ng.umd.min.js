/*!
 * Featureflow NG Angular 1 Client v0.6.4
 * Web: https://www.featureflow.io/
 * Date: 2017-07-03T01:41:38.572Z
 * Licence: Apache-2.0
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.FeatureflowProvider=t():e.FeatureflowProvider=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=1)}([function(e,t,n){/*!
 * Featureflow Client v0.6.1
 * Web: https://www.featureflow.io/
 * Date: 2017-05-02T04:20:46.640Z
 * Licence: Apache-2.0
 */
!function(t,n){e.exports=n()}(0,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=8)}([function(e,t,n){"use strict";t.a={INIT:"INIT",LOADED:"LOADED",LOADED_FROM_CACHE:"LOADED_FROM_CACHE",ERROR:"ERROR",UPDATED_FEATURE:"UPDATED_FEATURE"}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){try{return JSON.parse(localStorage.getItem("ff:"+t+":"+e)||"{}")}catch(e){return{}}}function i(e,t,n){return localStorage.setItem("ff:"+t+":"+e,JSON.stringify(n))}var a=n(4),s=n(3),u=n(0),c=n(6),f=n.n(c),l=n(5),p=n.n(l),d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},h=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),v="https://app.featureflow.io",y="https://rtm.featureflow.io",m={baseUrl:v,rtmUrl:y,streaming:!0,defaultFeatures:{},useCookies:!0},g=new Error("init() has not been called with a valid apiKey"),b=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=this,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};if(r(this,e),this.emitter=new f.a,this.apiKey=t,!this.apiKey)throw g;if(this.config=d({},m,s),this.updateContext(n),this.config.streaming){new window.EventSource(this.config.rtmUrl+"/api/js/v1/stream/"+this.apiKey).onmessage=function(e){var t=[];try{t=JSON.parse(e.data)}catch(e){}a.a.getFeatures(o.config.baseUrl,o.apiKey,o.context,t,function(e,t){e?(o.emitter.emit(u.a.ERROR,e),c(e)):(o.features=d({},o.features,t),i(o.apiKey,o.context.key,o.features),o.emitter.emit(u.a.UPDATED_FEATURE,t),c(void 0,t))})}}this.on=this.emitter.on.bind(this.emitter),this.off=this.emitter.off.bind(this.emitter)}return h(e,[{key:"updateContext",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};this.context={key:t.key||this.getAnonymousKey(),values:t.values},this.features=o(this.apiKey,this.context.key),setTimeout(function(){e.emitter.emit(u.a.LOADED_FROM_CACHE,e.features),a.a.getFeatures(e.config.baseUrl,e.apiKey,e.context,[],function(t,r){return t?(e.emitter.emit(u.a.ERROR,t),n(t)):(e.features=r||{},i(e.apiKey,e.context.key,e.features),e.emitter.emit(u.a.INIT,r),e.emitter.emit(u.a.LOADED,r),n(void 0,r)),e.context})},0)}},{key:"getFeatures",value:function(){return this.features}},{key:"getContext",value:function(){return this.context}},{key:"evaluate",value:function(e){var t=new s.a(this.features[e]||this.config.defaultFeatures[e]||"off");return a.a.postEvaluateEvent(this.config.baseUrl,this.apiKey,this.context.key,e,t.value(),function(){}),t}},{key:"goal",value:function(e){return a.a.postGoalEvent(this.config.baseUrl,this.apiKey,this.context.key,e,this.getFeatures(),function(){})}},{key:"getAnonymousKey",value:function(){return localStorage.getItem("ff-anonymous-key")||this.resetAnonymousKey()}},{key:"resetAnonymousKey",value:function(){var e="anonymous:"+Math.random().toString(36).substring(10);return localStorage.setItem("ff-anonymous-key",e),this.config.useCookies&&p.a.set("ff-anonymous-key",e),e}}]),e}();t.a=b},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t){r(this,e),this.storedValue=t.toLowerCase()}return o(e,[{key:"value",value:function(){return this.storedValue}},{key:"is",value:function(e){return e.toLowerCase()===this.value().toLowerCase()}},{key:"isOn",value:function(){return this.is("on")}},{key:"isOff",value:function(){return this.is("off")}}]),e}();t.a=i},function(e,t,n){"use strict";function r(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},r=new XMLHttpRequest;return r.addEventListener("load",function(){200===r.status&&"application/json;charset=UTF-8"===r.getResponseHeader("Content-Type")?n(null,JSON.parse(r.responseText)):n(r.statusText||"non 200 response status code")}),r.addEventListener("error",function(){n("error connecting with server")}),r.open(t.method,e),r.setRequestHeader("X-Featureflow-Client","javascript-"+a.a.version),t.body?(r.setRequestHeader("Content-Type","application/json"),r.send(JSON.stringify(t.body))):r.send(),r}function o(e){return btoa(JSON.stringify(e))}var i=n(7),a=n.n(i);t.a={getFeatures:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments[4],s=i.length>0?"?keys="+i.join(","):"";r(e+"/api/js/v1/evaluate/"+t+"/context/"+encodeURI(o(n))+s,{method:"GET"},a)},postGoalEvent:function(e,t,n,o,i,a){r(e+"/api/js/v1/event/"+t,{method:"POST",body:[{type:"goal",data:{contextKey:n,goalKey:o,hits:1,evaluated:i}}]},a)},postEvaluateEvent:function(e,t,n,o,i,a){r(e+"/api/js/v1/event/"+t,{method:"POST",body:[{type:"evaluate",data:{contextKey:n,featureKey:o,variant:i,hits:1}}]},a)}}},function(e,t,n){var r,o;!function(i){var a=!1;if(r=i,void 0!==(o="function"==typeof r?r.call(t,n,t,e):r)&&(e.exports=o),a=!0,e.exports=i(),a=!0,!a){var s=window.Cookies,u=window.Cookies=i();u.noConflict=function(){return window.Cookies=s,u}}}(function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var r in n)t[r]=n[r]}return t}function t(n){function r(t,o,i){var a;if("undefined"!=typeof document){if(arguments.length>1){if(i=e({path:"/"},r.defaults,i),"number"==typeof i.expires){var s=new Date;s.setMilliseconds(s.getMilliseconds()+864e5*i.expires),i.expires=s}try{a=JSON.stringify(o),/^[\{\[]/.test(a)&&(o=a)}catch(e){}return o=n.write?n.write(o,t):encodeURIComponent(String(o)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)),t=t.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),t=t.replace(/[\(\)]/g,escape),document.cookie=[t,"=",o,i.expires?"; expires="+i.expires.toUTCString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join("")}t||(a={});for(var u=document.cookie?document.cookie.split("; "):[],c=/(%[0-9A-Z]{2})+/g,f=0;f<u.length;f++){var l=u[f].split("="),p=l.slice(1).join("=");'"'===p.charAt(0)&&(p=p.slice(1,-1));try{var d=l[0].replace(c,decodeURIComponent);if(p=n.read?n.read(p,d):n(p,d)||p.replace(c,decodeURIComponent),this.json)try{p=JSON.parse(p)}catch(e){}if(t===d){a=p;break}t||(a[d]=p)}catch(e){}}return a}}return r.set=r,r.get=function(e){return r.call(r,e)},r.getJSON=function(){return r.apply({json:!0},[].slice.call(arguments))},r.defaults={},r.remove=function(t,n){r(t,"",e(n,{expires:-1}))},r.withConverter=t,r}return t(function(){})})},function(e,t){function n(){}n.prototype={on:function(e,t,n){var r=this.e||(this.e={});return(r[e]||(r[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){function r(){o.off(e,r),t.apply(n,arguments)}var o=this;return r._=t,this.on(e,r,n)},emit:function(e){var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),r=0,o=n.length;for(r;r<o;r++)n[r].fn.apply(n[r].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),r=n[e],o=[];if(r&&t)for(var i=0,a=r.length;i<a;i++)r[i].fn!==t&&r[i].fn._!==t&&o.push(r[i]);return o.length?n[e]=o:delete n[e],this}},e.exports=n},function(e,t){e.exports={name:"featureflow-client",version:"0.6.1",description:"Featureflow Javascipt Client",author:"Featureflow <featureflow@featureflow.io>",license:"Apache-2.0",keywords:["featureflow","feature","analytics","client"],files:["dist"],repository:{type:"git",url:"git+https://github.com/featureflow/featureflow-javascript-sdk.git"},main:"dist/featureflow",scripts:{"build-lib":"webpack src/index.js dist/featureflow.js","build-min":"webpack -p src/index.js dist/featureflow.min.js",build:"node ./scripts/build.js",watch:"webpack --watch src/index.js dist/featureflow.js",test:"karma start --single-run","test:watch":"karma start --auto-watch --reporters=dots",prepublish:"node ./scripts/build.js","publish:bower":"node ./scripts/bower.js",flow:"flow",example:"webpack-dev-server --config ./example/webpack.config.js --content-base example/ --inline --port 8182"},devDependencies:{babel:"^6.23.0","babel-core":"^6.23.1","babel-loader":"^6.3.0","babel-plugin-transform-flow-strip-types":"^6.22.0","babel-plugin-transform-object-rest-spread":"^6.23.0","babel-preset-es2015":"^6.22.0",chai:"3.5.0","css-loader":"^0.26.1","file-loader":"^0.10.0","flow-bin":"^0.39.0","gzip-size":"3.0.0","html-webpack-plugin":"^2.28.0","in-publish":"2.0.0",karma:"0.13.22","karma-chai":"0.1.0","karma-chrome-launcher":"1.0.1","karma-mocha":"1.0.1","karma-mocha-reporter":"2.0.4","karma-phantomjs-launcher":"0.2.1","karma-phantomjs-shim":"1.1.2","karma-sinon":"1.0.5","karma-sourcemap-loader":"0.3.7","karma-webpack":"2.0.2",mocha:"2.5.3",phantomjs:"1.9.18","pretty-bytes":"3.0.1","readline-sync":"1.4.4","semver-compare":"^1.0.0",sinon:"1.17.4","style-loader":"^0.13.1",webpack:"2.2.1","webpack-dev-server":"^2.3.0"},dependencies:{"js-cookie":"^2.1.3","tiny-emitter":"^1.1.0"}}},function(e,t,n){"use strict";(function(e){function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new o.a(e,t,n)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),i=n(0);t.init=r,n.d(t,"events",function(){return a});var a=i.a;t.default={init:r,events:a},void 0!==window.VERSION&&(e.exports.version=window.VERSION)}).call(t,n(2)(e))}])})},function(e,t,n){"use strict";function r(){this.apiKey="",this.context={},this.init=function(e,t){this.apiKey=e,this.context=t},this.$get=function(){return i.a.init(this.apiKey,this.context)}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=n.n(o);angular.module("ng-featureflow",[]).provider("featureflow",r)}])});